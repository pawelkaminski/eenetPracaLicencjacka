%
% Niniejszy plik stanowi przyk³ad formatowania pracy magisterskiej na
% Wydziale MIM UW.  Szkielet u¿ytych poleceñ mo¿na wykorzystywaæ do
% woli, np. formatujac wlasna prace.
%
% Zawartosc merytoryczna stanowi oryginalnosiagniecie
% naukowosciowe Marcina Wolinskiego.  Wszelkie prawa zastrze¿one.
%
% Copyright (c) 2001 by Marcin Woliñski <M.Wolinski@gust.org.pl>
% Poprawki spowodowane zmianami przepisów - Marcin Szczuka, 1.10.2004
% Poprawki spowodowane zmianami przepisow i ujednolicenie 
% - Seweryn Kar³owicz, 05.05.2006
% dodaj opcjê [licencjacka] dla pracy licencjackiej
\documentclass[licencjacka]{pracamgr}

\usepackage{polski}
\usepackage{hyperref}
\usepackage{indentfirst}

%Jesli uzywasz kodowania polskich znakow ISO-8859-2 nastepna linia powinna byc 
%odkomentowana
\usepackage[latin2]{inputenc}
%Jesli uzywasz kodowania polskich znakow CP-1250 to ta linia powinna byc 
%odkomentowana
%\usepackage[cp1250]{inputenc}

% Dane magistranta:

\author{Patryk Hes, Pawe³ Kamiñski, Borys Pop³awski, Robert Tomkowski}

\nralbumu{320327, 320408, 320372, 321179}

\title{Zr±b do aplikacji usprawniaj±cych pracê biurow±}

\tytulang{Framework for application improving office work}

%kierunek: Matematyka, Informatyka, ...
\kierunek{Informatyka w ramach Miêdzywydzia³owych Indywidualnych Studiów Matematyczno-Przyrodniczych}

% informatyka - nie okreslamy zakresu (opcja zakomentowana)
% matematyka - zakres moze pozostac nieokreslony,
% a jesli ma byc okreslony dla pracy mgr,
% to przyjmuje jedna z wartosci:
% {metod matematycznych w finansach}
% {metod matematycznych w ubezpieczeniach}
% {matematyki stosowanej}
% {nauczania matematyki}
% Dla pracy licencjackiej mamy natomiast
% mozliwosc wpisania takiej wartosci zakresu:
% {Jednoczesnych Studiow Ekonomiczno--Matematycznych}

% \zakres{Tu wpisac, jesli trzeba, jedna z opcji podanych wyzej}

% Praca wykonana pod kierunkiem:
% (podaæ tytu³/stopieñ imiê i nazwisko opiekuna
% Instytut
% ew. Wydzia³ ew. Uczelnia (je¿eli nie MIM UW))
\opiekun{dra Janusza Jab³onowskiego\\
  }

% miesi±c i~rok:
\date{Czerwiec 2014}

%Podaæ dziedzinê wg klasyfikacji Socrates-Erasmus:
\dziedzina{ 
%11.0 Matematyka, Informatyka:\\ 
%11.1 Matematyka\\ 
%11.2 Statystyka\\ 
11.3 Informatyka\\ 
}

%Klasyfikacja tematyczna wedlug AMS (matematyka) lub ACM (informatyka)
%TODO ZALEZY Z KTOREGO ROKU!!!!
% http://www.acm.org/about/class/ccs98-html
% http://dl.acm.org/ccs_flat.cfm#toc
\klasyfikacja{Information systems\\
  World Wide Web\\  
  Web services\\
  RESTful web services}


% S³owa kluczowe:
\keywords{zr±b, REST, WWW}%fa

% Tu jest dobre miejsce na Twoje w³asne makra i~¶rodowiska:
\newtheorem{defi}{Definicja}[section]

% koniec definicji

\begin{document}
\maketitle

%tu idzie streszczenie na strone poczatkowa
\begin{abstract}

\end{abstract}

\tableofcontents
%\listoffigures
%\listoftables


%TODO Robert/Pawe³ ~to chyba ma byæ krótkie natomiast sam pomys³ mo¿esz 
\chapter*{Wprowadzenie}
\addcontentsline{toc}{chapter}{Wprowadzenie}
Przedmiotem pracy licencjackiej jest opis zrêbu oraz jego implementacja wraz z przyk³adowymi aplikacjami.
Projekt zosta³ zlecony przez firmê Laboratorium EE\footnote{\url{http://laboratorium.ee/}}.
Klient zwróci³ sie do nas, gdy¿ potrzebowa³ narzêdzi do usprawnienia zarz±dzania firm± oraz do podniesienia poziomu komunikacji wewn±trz niej.
Problemy zleceniodawcy wyniknê³y z szybkiego ekspansywnego rozwoju firmy.
Aplikacja powsta³a w wyniku naszej pracy zosta³a nazwana EEnet, gdy¿ ma ³±czyæ pracowników firmy.

Praca sk³ada siê z~9 rozdzia³ów i~dodatków:
\begin{itemize}
\item[\ref{r:pojecia}]       -- podstawowe pojêcia u¿ywane w dokumencie,
\item[\ref{r:opis}]          -- ogólny opis problemu wraz z propozycj± rozwi±zania,
\item[\ref{r:konkurencja}]   -- zestawienie i analiza konkurencyjnych rozwi±zañ,
\item[\ref{r:technologie}]   -- przegl±d technologii zaadaptowanych w projekcie, zarówno back-endowych jak i front-endowych,
\item[\ref{r:wtyczki}]       -- opis dzia³ania poszczególnych gotowych wtyczek wraz z opisem ich logiki biznesowej i uprawnieñ u¿ytkowników,
\item[\ref{r:rozwiazania}]   -- konkretne rozwi±zania implementacyjne, które nie wynika³y wprost z zaprezentowanej przez klienta logiki biznesowej,
\item[\ref{r:praca}]         -- analiza wykonanej pracy nad projektem,
\item[\ref{r:osiagniecia}]   -- dotychczasowe osi±gniêcia zrêbu eenet oraz naszego zespo³u.

\end{itemize}


%TODO WSZYSCY WRZUCAJA TUTAJ JAK LECI CO JEST POTRZEBNE
\chapter{Podstawowe pojêcia}\label{r:pojecia}

\section{Definicje}

\begin{itemize}
\item framework -- bezpo¶rednio t³umaczony jako zr±b, jest to szkielet do budowy aplikacji;
\item eenet -- nazwa w³asna opisywanego zrêbu;
\item Laboratorium EE -- firma zg³aszaj±ca zapotrzebowanie na eenet;
\item wtyczka -- aplikacja korzystaj±ca z udogodnieñ ¶rodowiska zapewnianego przez eenet;
\item wtyczki przyk³adowe -- wtyczki, których stworzenie jest przewidziane w ramach wykonania aplikacji eenet;
\item przegl±darka internetowa - program instalowany na urz±dzeniu u¿ytkownika, umo¿liwiaj±cy wy¶wietlanie stron WWW dostarczanych przez serwer;
\item serwer produkcyjny -- komputer serwuj±cy stronê WWW, posiada bazê danych aplikacji;
\item serwer developerski (testowy) -- maszyna, która s³u¿y do testowania ka¿dej wersji aplikacji, zanim ta trafi na serwer produkcyjny;
\item kopia bezpieczeñstwa -- informacje, które maj± s³u¿yæ do odtworzenia oryginalnych danych znajduj±cych siê na serwerze produkcyjnym, w przypadku ich utraty lub uszkodzenia;
\item front-end -- czê¶æ kodu zapewniaj±ca graficzny i testowy interfejs, jest interpretowana przez przegl±darkê tzn. dzia³a po stronie u¿ytkownika;
\item back-end -- czê¶æ kodu dzia³aj±ca po stronie serwera, odpowiada za logikê operacji na danych;
\item aplikacja internetowa -- aplikacja w formie strony WWW, posiada front-end i back-end;
\item \textit{single-page application} -- podczas u¿ytkowania aplikacji tego typu nigdy nie zostaje prze³adowana strona, dane pomiêdzy klientem a serwerem s± przesy³ane przy pomocy zapytañ asynchronicznych;
\item UX (ang. \textit{User Experience}) -- do¶wiadczenia wizualne u¿ytkownika aplikacji internetowej, pozwalaj± okre¶liæ ³atwo¶æ, z jak± korzysta siê z aplikacji;
\item DRY (ang. \textit{Don`t Repeat Yourself}) -- regu³a stosowana podczas wytwarzania oprogramowania, zalecaj±ca unikanie ró¿nego rodzaju powtórzeñ wykonywanych przez programistów -- na przyk³ad unikanie tych samych czynno¶ci podczas kompilowania, unikanie wklejania (lub pisania) tych samych (lub bardzo podobnych) fragmentów kodu w wielu miejscach. W przypadku powtarzaj±cego siê kodu ¼ród³owego mo¿na separowaæ powtarzaj±cy siê fragment i jedynie odwo³ywaæ siê do niego;
\item API (ang. \textit{Application Programming Interface}) -- ¶ci¶le okre¶lony zestaw regu³ i ich opisów, specyfikuj±cych sposób w jaki front-end komunikuje siê z back-endem;
\item REST (ang. \textit{REpresentational State Transfer}) -- wzorzec architektury oprogramowania standaryzuj±cy regu³y API;
\item GUI (ang. \textit{Graphical User Interface}) -- interfejs u¿ytkownika, w przypadku aplikacji eenet ca³a komunikacja na linii aplikacja-u¿ytkownik odbywa siê poprzez przegl±darkê internetow±;
\item HTML (ang. \textit{HyperText Markup Language}) -- deklaratywny jêzyk opisu tre¶ci strony;
\item DOM (ang. \textit{Document Object Model}) -- drzewiasta reprezentacja strony HTML, trzymana w pamiêci przegl±darki;
\item CSS (ang. \textit{Cascading Style Sheets}) -- deklaratywny jêzyk opisu stylowania elementów HTML;
\item responsywno¶æ -- zdolno¶æ strony do aran¿acji uk³adu tre¶ci w zale¿no¶ci od szeroko¶ci okna przegl±darki b±d¼ urz±dzenia, na którym stronê siê przegl±da;
\item JS (ang. \textit{JavaScript}) -- jêzyk skryptowy odpowiedzialny za zapytania AJAX i manipulacjê drzewem DOM;
\item AJAX (ang. \textit{Asynchronous JavaScript and XML}) -- technika pozwalaj±ca na wykonywanie asynchronicznych zapytañ HTTP do API;
\item ma³e i ¶rednie przedsiêbiorstwa -- firmy zatrudniaj±ce od 10 do 250 pracowników;
\item UI (ang. \textit{User Interface}) -- interfejs u¿ytkownika -- czê¶æ aplikacji odpowiedzialna za interakcjê z odbiorc± koñcowym;
\item \textit{open source} -- otwarte oprogramowanie -- oprogramowanie, którego licencja pozwala na legalne i nieodp³atne kopiowane zarówno kodu wynikowego jak i ¼ród³owego oraz na dowolne modyfikacje kodu ¼ród³owego;
\item OAuth -- otwarty standard autoryzuj±cy, pozwalaj±cy u¿ytkownikom dzieliæ swoje zasoby(np. dane, kontakty, zdjêcia) przechowywane na jednej stronie z inn± stron±. Dziêki temu mo¿na u¿ywaæ jednego konta(np. Google, Facebook, Twitter itp.) do logwania siê w wielu miejscach;
\item RGB (ang. Red Green Blue) -- jeden z modeli przestrzeni barw, opisywany trzema wspó³rzêdnymi: czerwon±, zielon± i niebiesk±.

\end{itemize}

%TODO Robert
\chapter{Opis projektu}\label{r:opis}

\section{Zarys zagadnienia}
Okazuje siê, ¿e przy zarz±dzaniu firm± do wielu problemów nie wystarczaj± arkusze kalkulacyjne, dokumenty tekstowe i komunikatory -- potrzeba oprogramowania, które nada zgromadzonym danym sens w ramach kontekstu logiki biznesowej.

Jako, ¿e nie nikt nie by³ i nigdy nie bêdzie w stanie zdefiniowaæ ostatecznych wymagañ dla problemu zarz±dzania firm±, zdecydowali¶my ¿e najlepszym rozwi±zaniem bêdzie stworzenie zrêbu.

Takie rozwi±zanie zapewnia ³atw± w~przysz³o¶ci rozszerzalno¶æ, w~dodatku dziêki posiadaniu ¶rodowiska s³u¿±cego do tworzenia i~obs³ugi aplikacji biurowych,
mo¿na znacznie ograniczyæ koszty pisania poszczególnych funkcjonalno¶ci. ¦rodowisko bêdzie zapewnia³o pomocnicze funkcjonalno¶ci wtyczkom (np. dostêp do bazy danych, logowanie u¿ytkowników, uprawnienia) -- wtyczki dziêki temu nie bêd± musia³y same siê zajmowaæ tymi kwestiami, takie rozumowanie jest zgodne z zasad± DRY.

Dodatkow± zalet± jest ujednolicenie podej¶cia, jakie nale¿y zastosowaæ pisz±c tak± aplikacjê -- dziêki temu bêdzie mo¿na ³atwo wdro¿yæ nowego programistê aplikacji.
Oczywi¶cie takie ujednolicenie wi±¿e siê z narzuceniem pewnych barier, lecz w naszej ocenie przy rozwi±zywaniu tego typu problemu ograniczenia pojawia siê wcze¶niej czy pó¼niej, wiêc lepiej ustanowiæ je na samym pocz±tku.

\section{Wymagania}

Samo stworzenie ¶rodowiska nie rozwi±¿e jednak obecnych problemów zleceniodawcy, utworzyli¶my wiêc kilka podstawowych wtyczek pomagaj±cych Laboratorium EE.
W~pocz±tkowej fazie negocjacji z~klientem wynik³y nastêpuj±ce wymagania dotycz±ce zestawu ,,zr±b + gotowe wtyczki'':
\begin{itemize}
 \item Udostepniæ zaawansowany system zarz±dzania u¿ytkownikami.
 \item Stworzyæ mechanizmy do inwentaryzacji dóbr i informacji.
 \item Zautomatyzowaæ proces sk³adania pró¶b o urlopy w firmie.
\end{itemize}
Jako podstawê aplikacji stworzyli¶my trzy wtyczki:
\begin{itemize}
 \item \nameref{r:uzytkownicy}
 \item \nameref{r:powiadomienia}
 \item \nameref{r:kafle}
\end{itemize}
Dwie kolejne rozwi±zuj± problemy z inwentaryzacj± i urlopami:
\begin{itemize}
 \item \nameref{r:urlopy}
 \item \nameref{r:zasoby}
\end{itemize}

Ca³e oprogramowanie powstawa³o przy ¶cis³ej wspó³pracy z klientem, zarówno przy ustalaniu specyfikacji, jak i od strony merytorycznej.

Do koñcowej implementacji projektu eenet zosta³ dodany podrêcznik u¿ytkownika oraz opis instalacji i konfiguracji aplikacji.

%TODO Pawe³
\chapter{Rozwi±zania konkurencyjne}\label{r:konkurencja}
\section{Wymagania zamawiaj±cego}
Laboratorium EE postawi³o kilka wymagañ dotycz±cych tworzonej aplikacji. Po pierwsze rozwi±zanie musia³obyæ aplikacj± webow±, umo¿liwiaj±c± postawienie jej na prywatnym serwerze, tak aby mieæ pewno¶æ co do bezpieczeñstwa przechowywanych danych. Pondato stworzona aplikacja musi mieæ mo¿liwo¶æ po³±czenia z pozosta³ymi wewn±trzfirmowymi produktami oraz spe³niaæ logikê biznesow± zaproponowan± przez zamawiaj±cego. Ostatnim kryterium odno¶nie nowego produktu by³a jego cena.
\section{Przegl±d rozwi±zañ konkurencyjnych}
\subsection{Atlassian}
Firma Atlassian dostarcza szeroki wachlarz aplikacji do zarz±dzania prac±. Ka¿da z funkcjonalno¶ci jest oddzieln± aplikacj±. Jest to zdecydowanie najlepiej wykonane narzêdzie na rynku jednak¿e cena ka¿dej z funkcjonalno¶ci jest bardzo wysoka i zwykle tylko du¿e przedsiêbiorstwa staæ na wykup potrzebnych licencji.
\subsection{AppFlower}
Framework z otwartym ¼ród³em do tworzenia ma³ych aplikacji, nie wymagaj±cy programowania, pozwalaj±cy na budowanie aplikacji z klocków. Plusem tego rozwi±zania jest to ¿e jest darmowy i otwarty, natomiast minusem fakt, ¿e budowane w nim aplikacje nie pozwalaj± na zaimplementowanie zaawansowanej logiki biznesowej.
\subsection{OpenBiz AppBuilder}
P³atny framework do tworzenia ma³ych aplikacji, pozwalaj±cy na handlowanie nimi. Mocn± stron± tego rozwi±zania jest do¶æ du¿a dowolno¶æ w tworzeniu nowych aplikacji, natomiast s³ab± -- jej do¶æ wysoka cena oraz brak dobrej dokumentacji do ¶rodowiska tworzenia nowych wtyczek.
\subsection{Mindquarry}
Aplikacja z otwartym ¼ród³em pozwalaj±ca na przesy³anie plików, zarz±dzanie zasobami firmowymi oraz kierowanie projektami. Plusem tego rozwi±zania jest to ¿e darmowe oraz pozwala na dowolne tworzenie nowych aplikacji, natomiast minusem fakt, ¿e jest nie rozwijane, napisane w starej technologi oraz nie istnieje dokumentacja kodu.
\section{Podsumowanie rozwi±zañ konkurencyjnych}
Ka¿de ze znalezionych rozwi±zañ mia³o swoje dobre strony, jednak¿e ¿adne nie spe³nia³o wszystki warunków postawionych przez zamawiaj±cego.

%TODO Patryk
\chapter{Zaadaptowane technologie}\label{r:technologie}

\section{Ogólna struktura projektu}

Zdecydowali¶my siê na realizacjê aplikacji internetowej jako interaktywnej strony WWW, co jest naturalnym wyborem zwa¿ywszy na to ile narzêdzi obecnie jest dostêpnych w ten sposób. Dodatkowo za³o¿yli¶my, ¿e nasza strona powinna spe³niaæ wzorzec \textit{single-page application}, który wymusza ¶cis³y podzia³ projektu na API i GUI.

\section{Back-end: instalacja projektu}

Back-end eenetu zosta³ stworzony we frameworku Django. S³u¿y on nastêpuj±cym celom:
\begin{itemize}
\item zapewnia mechanizm sesji zalogowanego u¿ytkownika,
\item po¶redniczy w logowaniu i autoryzacji OAuth,
\item zawiera w sobie koñcówki API, z którymi komunikuje siê GUI.
\end{itemize}

Do uruchomienia aplikacji w trybie deweloperskim (przy ustawionym \verb+DEBUG = True+ w ustawieniach projektu) wystarczy sam kod zapewniany przez Django, mianowicie plik
\verb+manage.py+ -- Django zajmuje siê wówczas uruchomieniem serwera HTTP obs³uguj±cego zarówno ¿±dania zwi±zane z API, jak i serwowanie plików statycznych.

Do instalacji produkcyjnej potrzeba jednak po¶rednicz±cego serwera-bramy, który zajmie siê serwowaniem plików statycznych i przekierowaniem odpowiednich ¿±dañ do Django. Zdecydowali¶my siê na serwer nginx z powodu popularno¶ci takiego po³±czenia Django - nginx. Oczywi¶cie zawsze jest mo¿liwo¶æ zmiany serwera-bramy na np. Apache2 czy lighttpd.

Oprócz ustalenia serwera-bramy, nale¿y te¿ w jaki¶ sposób uruchomiæ serwer Django na produkcji. W tym celu u¿yli¶my narzêdzia supervisord, które powoduje, ¿e nie trzeba pisaæ osobnego daemona do procesu Django.

Eenet zosta³ przygotowany równie¿ na obs³ugê zadañ asynchronicznych -- czyli takich, które mo¿na zrobiæ osobnym procesem, nie spowalniaj±c renderowania odpowiedzi serwera. Przyk³adem tego mo¿e byæ pobieranie zdjêcia u¿ytkownika -- poniewa¿ autoryzacja u¿ytkowników odbywa siê przy pomocy Google OAuth, aplikacja eenet mo¿e wys³aæ ¿±danie do Google+ API o takowe zdjêcie. W celu wykonania tej funkcjonalno¶ci ponownie zwrócili¶my siê do rozwi±zañ popularnych -- wykorzystali¶my Celery, asynchroniczn± kolejkê zadañ w po³±czeniu z brokerem zadañ Rabbitmq.

Z uwagi na to, ¿e postawienie pe³nego produkcyjnego serwera posiada wiele zale¿no¶ci, sporz±dzili¶my instrukcjê, która prowadzi administratora aplikacji krok po kroku, zaczynaj±c od stawiania instalacji deweloperskiej, poprzez produkcyjn±, a¿ po uruchamianie zadañ asynchronicznych. Znajduje siê ona w pliku \verb+README.md+.

\section{Back-end: implementacja API}

Kluczow± rolê spe³nia wspomniany wcze¶niej framework Django. Oczekiwali¶my od back-endowego frameworku nastêpuj±cych funkcjonalno¶ci:
\begin{itemize}
\item ³atwy dostêp do bazy danych SQL,
\item sesje u¿ytkowników,
\item interfejs do administracji danymi dla administratora,
\item mechanizm autoryzacji OAuth kompatybilny z Google OAuth,
\item mo¿liwo¶æ ³atwego stworzenia wielu koñcówek API dostêpnych pod ró¿nymi adresami URL,
\item narzucenie ograniczeñ na dostêp do koñcówek w zale¿no¶ci od przywilejów poszczególnych u¿ytkowników.
\end{itemize}

Dostêp do bazy danych, sesje u¿ytkowników i interfejs administracyjny s± zapewnione przez samo Django. Do obs³ugi OAuth zdecydowali¶my siê na \verb+django-social-auth+ (pó¼niej projekt przeistoczy³ siê w \verb+python-social-auth+), natomiast do stworzenia API u¿yli¶my \verb+django-rest-framework+.

Przyjête przez nas rozwi±zania zdecydowanie u³atwi³y pracê z projektem i umo¿liwi³y skupienie siê na logice biznesowej.


\section{Front-end: JavaScript}

Koncepcja stron internetowych typu \textit{single-page application} pojawi³a siê w 2003 r. \cite{spa} i pierwsze realizacje zaczê³y pojawiaæ siê w podobnym czasie. Wówczas bardzo niszowe, obecnie staj± siê coraz bardziej popularne, g³ównie za spraw± implementacji w przegl±darkach History API i pojawieniu siê wielu frameworków zapewniaj±cych ³atwe tworzenie \textit{single-page application}, takich jak AngularJS, Backbone czy Ember.

Zdecydowali¶my siê na u¿ycie AngularJS g³ównie ze wzglêdu na popularno¶æ, przy okazji jest to projekt za którym stoj± deweloperzy Google'a, wiêc bardzo prawdopodobne, ¿e bêdzie w dalszym ci±gu rozwijany i wspierany.

AngularJS zapewnia nam wzorzec MVW  -- \textit{model-view-whatever}\footnote{\url{https://plus.google.com/110323587230527980117/posts/aZNVhj355G2}}, stanowi±cy po³±czenie popularnych wzorców MVC -- \textit{model-view-controller} i MVVM -- \textit{model-view-viewmodel}.

Oprócz tego, AngularJS zapewnia:
\begin{itemize}
\item obs³ugê History API -- zmiana URLa przez JavaScript nie powoduje prze³adowania strony od nowa, tylko modyfikuje istniej±cy dokument HTML (¶ci¶lej drzewo DOM) tak, ¿eby uzyskaæ po¿±dany widok,
\item podzia³ logiczny front-endu na kontrolery, szablony i serwisy,
\item \textit{two-way data binding} - automatyczn± synchronizacjê tre¶ci miêdzy zawarto¶ci± strony (drzewem DOM), a warto¶ciami zmiennych w JavaScripcie,
\item obiektowe podej¶cie do AJAXowej komunikacji z koñcówkami API dziêki serwisowi \verb+$resource+,
\item internacjonalizacjê tre¶ci strony przy pomocy \verb+ng-l20n+.
\end{itemize}

Jak widaæ AngularJS spe³nia wiele zadañ. Na potrzeby eenetu wystarcza ca³kowicie, je¶li chodzi o kwestie ¿±dañ AJAX i manipulacji drzewem DOM. W aplikacji eenet bardzo czêsto pojawia³a siê jednak potrzeba operowania na strukturach danych z poziomu JavaScriptu. Tutaj znale¼li¶my zastosowanie dla biblioteki Lo-Dash, która zawiera zbiór przydatnych funkcji do manipulacji listami i s³ownikami (np. \verb+foreach+, \verb+map+, \verb+reduce+).

\section{Front-end: CSS}

Jêzyk HTML ma wbudowane podstawowe tagi, które spe³niaj± jasno okre¶lon± rolê w interfejsie (np. \verb+button+, \verb+select+), jednak¿e jest du¿a dowolno¶æ w kwestii wizualnego zaplanowania interfejsu. Zamiast wymy¶laæ strukturê stron HTML ca³kowicie od podstaw i pisaæ w³asne style CSS upiêkszaj±ce domy¶lne formatowanie, skorzystali¶my z biblioteki Bootstrap wykonanej przez firmê Twitter. Dziêki niej stworzyli¶my tak± strukturê HTML strony, któr± mo¿na ³atwo modyfikowaæ.

Dodatkowo, style z Bootstrapa s± responsywne -- zatem nie musieli¶my siê przejmowaæ, ¿e trzeba napisaæ osobny kod HTML i osobne style dla u¿ytkowników smartfonów i tabletów.




%TODO Patryk
\chapter{Wtyczki}\label{r:wtyczki}



\section{U¿ytkownicy}\label{r:uzytkownicy}

\subsection{Opis}
Wtyczka U¿ytkownicy jest w zasadzie integraln± czê¶ci± frameworku eenet, jest ¶ci¶le powi±zana z logowaniem i autoryzacj± u¿ytkowników. Oprócz tego zapewnia system uprawnieñ -- ka¿da inna wtyczka mo¿e zdefiniowaæ we wtyczce U¿ytkownicy jakie uprawnienia s± dostêpne w ramach tej¿e wtyczki. Domy¶lnie ka¿da wtyczka definiuje uprawnienia:
\begin{itemize}
\item \verb+admin+ -- u¿ytkownik maj±cy to uprawnienie powinien móc zrobiæ wszystko, co jest dostêpne wewn±trz wtyczki,
\item \verb+access+ -- u¿ytkownik maj±cy to uprawnienie powinien mieæ dostêp co najmniej do podstawowych funkcjonalno¶ci wtyczki.
\end{itemize}
Pozosta³e rodzaje uprawnieñ s± oczywi¶cie definiowane dla konkretnej wtyczki.


Kolejn± rzecz± zrealizowan± wewn±trz tej wtyczki s± grupy u¿ytkowników. ¯eby unikn±æ ¿mudnego przydzielania uprawnieñ u¿ytkownik po u¿ytkowniku, mo¿na ich wszystkich dodaæ do pewnej grupy i ustawiæ te uprawnienia grupie. Poza uprawnieniami i list± cz³onków grupa posiada równie¿ listê mened¿erów -- ta funkcjonalno¶æ jest zwi±zana z logik± biznesow± hierarchii pracowników w firmie Laboratorium EE (wiêcej na ten temat w opisie wtyczki \nameref{r:urlopy}).

\subsection{Uprawnienia}\label{r:uprawnienia}

Ka¿dy u¿ytkownik wtyczki U¿ytkownicy ma dostêp do listy u¿ytkowników eenetu oraz podgl±d ich podstawowych danych i uprawnieñ.

Administrator wtyczki U¿ytkownicy mo¿e dodatkowo modyfikowaæ uprawnienia poszczególnych u¿ytkowników lub grup do poszczególnych wtyczek.



\section{Powiadomienia}\label{r:powiadomienia}

\subsection{Opis}

Wtyczka Powiadomienia to kolejna integralna wtyczka zrêbu eenet -- ka¿da inna wtyczka mo¿e przy jej pomocy wys³aæ komunikat do u¿ytkownika.

Wy¶wietlanie wiadomo¶ci odbywa siê podobnie jak w portalach spo³eczno¶ciowych -- w g³ównym menu przy przycisku Powiadomienia pojawia sie liczba nieprzeczytanych wiadomo¶ci. Przej¶cie do g³ównego widoku Powiadomieñ powoduje wylistowanie wiadomo¶ci, przy czym wiadomo¶ci nieprzeczytane s± wyró¿nione w stosunku do przeczytanych.

\subsection{Uprawnienia}
Ka¿dy u¿ytkownik mo¿e przegl±daæ otrzymane powiadomienia oraz je usuwaæ.
Administrator nie posiada ¿adnych dodatkowych uprawnieñ.



\section{Urlopy}\label{r:urlopy}

\subsection{Opis}
Wtyczka Urlopy pozwala na sk³adanie wniosków o przyznanie urlopu oraz zarz±dzanie nimi. Z ka¿dy u¿ytkownikiem zwi±zana jest liczba przys³uguj±cych mu wolnych dni do wykorzystania na urlopy.
W odniesieniu do tej wtyczki administratorem jest osoba z uprawnieniem \verb+admin+ we wtyczce Urlopy.
Z ka¿dym wnioskiem zwi±zana jest liczba dni roboczych w trakcie tego urlopu, która zostaje odjêta od ilo¶ci pozosta³ych dni wolnych danego u¿ytkownika.
Wtyczka Urlopy pozwala tak¿e na zmianê (przez uprawnione osoby) ilo¶ci dni wolnych, przys³uguj±cych dowolnemu u¿ytkownikowi.

Dok³adniejsza logika biznesowa aplikacji znajduje siê w kolejnych podpunktach.

\subsection{Algorytm przyznawania urlopów}

Przyznawanie urlopów odbywa siê w kilku krokach:
\begin{enumerate}
\item
	Urlopobiorca klika ,,Z³ó¿ pro¶bê'' w urlopowniku i wype³nia potrzebne dane:
	\begin{itemize}
	\item daty od-do urlopu,
	\item typ urlopu,
	\item komentarz do wniosku,
	\item osobê, która ma zast±piæ,
	\item koordynatora urlopu.
	\end{itemize}
\item
	Wybrany koordynator dostaje powiadomienie, ¿e ma wniosek do przejrzenia.
\item
	Pierwszy etap akceptacji -- koordynator akceptuje b±d¼ nie dany wniosek. \\
	Je¿eli nie akceptuje:
	\begin{itemize}
	\item urlopobiorca dostaje powiadomienie o odrzuceniu wniosku.
	\end{itemize}
	Je¿eli akceptuje:
	\begin{itemize}
	\item urlopobiorca dostaje powiadomienie o zaakceptowaniu wniosku przez koordynatora
	\item wszyscy administratorzy dostaj± powiadomienie o konieczno¶ci dalszej weryfikacji wniosku i przechodzimy do punktu 4.
(je¶li wybrany koordynator jest przypadkiem administratorem, mo¿e zrobiæ punkty 3. i 4. za jednym zamachem)
	\end{itemize}
\item
	Drugi etap akceptacji - administrator akceptuje b±d¼ nie dany wniosek. \\
	Je¿eli nie akceptuje:
	\begin{itemize}	
	\item urlopobiorca dostaje powiadomienie o odrzuceniu wniosku
	\end{itemize}	
	Je¿eli akceptuje:
	\begin{itemize}	
	\item urlopobiorca dostaje powiadomienie o zaakceptowaniu wniosku.
	\end{itemize}

\end{enumerate}

\subsection{Przydzia³ dostêpnych koordynatorów}

Koordynatorem urlopu mo¿e byæ:
\begin{itemize}
\item dla zwyk³ego u¿ytkownika -- dowolny mened¿er dowolnej grupy, do której nale¿y dany u¿ytkownik,
\item dla mened¿era pewnej grupy -- dowolny mened¿er dowolnej grupy, do której nale¿y dany u¿ytkownik-mened¿er albo dowolny administrator Urlopów,
\item dla administratora Urlopów -- dowolny mened¿er dowolnej grupy, do której nale¿y dany u¿ytkownik-administrator albo dowolny administrator Urlopów.
\end{itemize}

\subsection{Uprawnienia}
Ka¿dy u¿ytkownik mo¿e przegl±daæ swoje wnioski o urlop oraz edytowaæ te jeszcze nie zaakceptowane. Ponadto mo¿e zmieniaæ status swoich wniosków na odrzucone.

Koordynator mo¿e akceptowaæ, odrzucaæ lub cofaæ do poprawki wnioski u¿ytkowników grup, których jest menad¿erem.

Administrator mo¿e akceptowaæ, odrzucaæ lub cofaæ do poprawki wnioski ju¿ zaakceptowane przez koordynatora. Ponadto mo¿e zmieniaæ liczbê dni wolnych przys³uguj±cych u¿ytkownikom.



\section{Zasoby}\label{r:zasoby}

\subsection{Opis}
Wtyczka Zasoby pozwala na zarz±dzanie zasobami biurowymi. Mog± byæ to zasoby materialne -- np. biurka, monitory, drukarki; mog± to byæ zasoby niematerialne -- jak np. licencja na oprogramowanie, klucz publiczny SSH. Oczywi¶cie ró¿ne instalacje eenetu mog± siê ró¿niæ rodzajami zasobów i informacjami w nich trzymanymi, zatem przygotowali¶my kilka przyk³adowych modeli potrzebnych akurat w Laboratorium EE, natomiast w razie potrzeby mo¿na je ³atwo zmodyfikowaæ.

Ka¿dy zasób posiada informacje o przynale¿no¶ci do u¿ytkownika b±d¼ listy u¿ytkowników oraz pola takie, jakie akurat s± potrzebne w modelu. Ponadto trzeba zdefiniowaæ uprawnienia do tworzenia, modyfikacji, usuwania instancji danego zasobu -- wiêcej o tym w podrozdziale \nameref{r:metaklasy}.

Wtyczka posiada kilka widoków: listowanie zasobów po rodzaju, listowanie zasobów po w³a¶cicielu, tworzenie i modyfikacja danego zasobu.
\subsection{Uprawnienia}
Ka¿dy u¿ytkownik mo¿e tworzyæ, modyfikowaæ i usuwaæ zasoby, których jest w³a¶cicielem, o ile dany model na to pozwala -- jest to okre¶lane przez flagê \verb+can_owner_edit+ w definicji modelu zasobu.

Ka¿dy u¿ytkownik mo¿e mieæ pe³en wgl±d w dowolny zasób, o ile dany model na to pozwala -- jest to okre¶lane przez flagê \verb+can_others_read+ w definicji modelu zasobu.

Administrator aplikacji Zasoby ma pe³en dostêp do wszystkich zasobów.

Oprócz standardowych uprawnieñ \verb+admin+ i \verb+access+ przewidziano równie¿ uprawnienia dynamicznie generowane, po jednym dla ka¿dego zasobu. Przyk³adowo, je¿eli zdefiniujemy zasób \textit{Monitor}, mo¿na nadaæ u¿ytkownikom uprawnienie \verb+monitor+ -- oznacza ono mo¿liwo¶æ pe³nej administracji tym typem zasobów.



\section{Kafle}\label{r:kafle}

\subsection{Opis}
Na stronie g³ównej aplikacji eenet znajduj± siê kafle wzorowane na Metro UI z Windows 8. Klikniêcie na taki kafel pozwala przej¶æ do wybranej aplikacji, przy okazji na kaflu mog± byæ umieszczone podsumowanie najwa¿niejszych informacji jakie dana wtyczka ma za zadanie zaprezentowaæ.

Sama wtyczka Kafle s³u¿y do tego, ¿eby oprócz kafli zwi±zanych z wtyczkami móc tworzyæ kafle niestandardowe, które mo¿na tworzyæ bez modyfikacji kodu we frameworku. Przy pomocy wtyczki Kafle mo¿na takie kafle tworzyæ, ustawiaæ im kolor t³a, tekst, obrazek i URL otwierany po ich klikniêciu.

\subsection{Uprawnienia}
Ka¿dy u¿ytkownik widzi niestandardowe kafle na stronie g³ównej. Tylko administrator wtyczki Kafle mo¿e tworzyæ, modyfikowaæ, usuwaæ kafle.


%TODO Patryk
\chapter{Rozwi±zania implementacyjne}\label{r:rozwiazania}

\section{Rozwi±zanie generyczne}

W wielu przypadkach implementacja funkcjonalno¶ci eenetu sprowadza³a siê do postêpowania zgodnie z zasadami konkretnego frameworka czy biblioteki. Przyk³adowo, gdy chcieli¶my stworzyæ w aplikacji kafle z hiper³±czami na stronie g³ównej, nale¿a³o stworzyæ:
\begin{itemize}
\item djangowy model kafla (w \verb+models.py+),
\item koñcówkê API odpowiedzialn± za pobieranie, tworzenie, aktualizacjê, usuwanie kafla przy pomocy \verb+django-rest-framework+ (pliki \verb+views.py+, \verb+urls.py+, \verb+permissions.py+, \verb+serializers.py+),
\item pobieranie z API do GUI kafli w odpowiednim angularowym kontrolerze,
\item wy¶wietlanie kafli w wybranym przez nas angularowym szablonie.
\end{itemize}

Tego typu rozwi±zanie pojawia³o siê bardzo czêsto w tworzonym przez nas kodzie. Mieli¶my jednak nieraz do czynienia ze skomplikowan± logik± biznesow±, która powodowa³a, ¿e trzeba by³o dane zagadnienie rozwi±zaæ w nieco inny sposób.

\section{System uprawnieñ}

Problemem okaza³o siê stworzenie systemu uprawnieñ, który pasowa³by do logiki aplikacji biznesowej potencjalnie ka¿dej wtyczki dzia³aj±cej w eenecie. Najbardziej rozwiniêtymi wtyczkami, jak± mieli¶my okazjê implementowaæ przy okazji implementowania samego zrêbu eenet by³y \nameref{r:urlopy} i \nameref{r:zasoby}.

Na potrzeby dwuetapowej weryfikacji wniosku urlopowego stworzyli¶my grupy u¿ytkowników. Rozwi±zanie to niestety wystaje poza sam± wtyczkê Urlopy i zachodzi na kompetencje wtyczki U¿ytkownicy, tote¿ musieli¶my zrobiæ grupy tak, aby da³o siê je potencjalnie wykorzystaæ ponownie w kolejnych wtyczkach.

Logika biznesowa wtyczki Zasoby wymaga³a natomiast, ¿eby stworzyæ uprawnienia administracyjne do poszczególnych zasobów. Oprócz tego jest kwestia publiczno¶ci i prywatno¶ci zasobów -- o tym wiêcej w kolejnym dziale.

\section{Metaklasy we wtyczce \textit{Zasoby}}\label{r:metaklasy}

Wewn±trz wtyczki Zasoby znajduje siê wiele modeli, które maj± ró¿ne pola, ró¿ne formularze edycyjne, ale maj± bardzo podobn± logikê uprawnieñ. Mo¿emy podzieliæ zasoby nastêpuj±co:
\begin{itemize}
\item instancja zasobu ma jednego w³a¶ciciela -- przyk³adowo, klucz publiczny SSH mo¿e nale¿eæ do jednej osoby,
\item instancja zasobu ma wielu w³a¶cicieli -- przyk³adowo, jedna licencja na oprogramowanie mo¿e byæ na wiele stanowisk,
\item instancja zasobu ma wiele podinstancji -- przyk³adowo, mamy w firmie 20 monitorów 24'' marki Contoso, z których 5 ma Alicja, a 3 ma Bartek.
\end{itemize}

Oprócz tego nale¿y w modelu zdefiniowaæ flagê \verb+can_owner_edit+ -- czy w³a¶ciciel mo¿e edytowaæ dany zasób (co jest potrzebne w celu unikniêcia znikania kosztownych zasobów z rejestru) oraz flagê \verb+can_others_read+ -- czy u¿ytkownicy niebêd±cy w³a¶cicielami mog± dany zasób widzieæ (przydatne we wszelkich has³ach dostêpu, licencjach na oprogramowanie).

W celu realizacji tego, pos³u¿yli¶my siê metaklasami pythona. Dziêki ich wykorzystaniu definicja modelu zajmuje kilkana¶cie linijek, a poza modelem nale¿y jedynie stworzyæ formularz edycyjny.

\section{Wersjonowanie}

W celu zapamiêtania historii zmian w bazie danych zosta³o zaimplementowane wersjonowanie. Zosta³ do tego wykorzystany dodatego do Django o nazwie \verb+django-reversion+. Zapamiêtuje on wszystkie dokonane zmiany instancji djangowych modeli(np. u¿ytkownika, zasobu, wniosku o urlop) oraz pozwala na ³atwe przywracanie poprzednich wersji.

Dziêki u¿yciu wersjonowania administratorzy posiadaj± kompletn± historiê zmian, co rozwi±zuje problem niechcianych zmian (np. pomy³ek) w aplikacji eenet.


%TODO Patryk
\chapter{W³o¿ona w projekt praca}\label{r:praca}

\textit{Do zrobienia.}

% TODO tutaj co¶ na kszta³t timeline'u kiedy kto co robi³
% i krotkie podsumowanie ile linii kodu pythona, javascriptu napisano (?)

%TODO Pawe³
\chapter{Osi±gniêcia}\label{r:osiagniecia}
\section{Produkt}
Aplikacja eenet znajduje siê pod adresem \url{https://eenet.laboratorium.ee}.
Wtyczki zawarte w niej zgodnie z za³o¿eniem zamawiaj±cego s± u¿ywane przez pracowników firmy Laboratorium EE. O sukcesie ¶wiadczy ponad 50 zarejestrowanych u¿ytkowników oraz du¿a liczba zg³oszonych przez nich uwag odno¶nie aplikacji. Uwagi zg³aszane przez u¿ytkowników mia³y ró¿norakie pod³o¿e, poczynaj±c od b³êdów w t³umaczeniach, przechodz±c przez uwagi dotycz±cye zmian w interfejsie u¿ytkownika, a koñcz±c na pro¶bach o dodanie nowej logiki w aplikacji. Ponadto planowane jest dalsze rozwijanie aplikacji przez przysz³ych praktykantów w Laboratorium EE. Co wiêcej, planowana jest sprzeda¿ eenetu w pakiecie wraz z innymi produktami firmy przeznaczonymi dla ma³ych i ¶rednich przedsiêbiorstw. 

\section{Tworzenie produktu}
Sposób w jaki powsta³a aplikacja, czas jej wykonania oraz jako¶æ wykonania zadowoli³ klienta na tyle, ¿e wszystkim cz³onkom zespo³u zosta³a zaproponowana dalsza wspó³praca w nowych projektach.

\textit{Dalsza czê¶æ do zrobienia.}


%TODO niby all ale i tak bedzie musiala napisac to jedna osoba - nie robert; moge to zrobic(borys) jak ktos mi powie co tu ma sie znalezc, bo nie wiem
\chapter{Zawarto¶æ kodu dostarczonego wraz z prac±}\label{r:kod}


\begin{thebibliography}{99}
\addcontentsline{toc}{chapter}{Bibliografia}

\bibitem{angularjs} Dokumentacja AngularJS - \url{https://docs.angularjs.org/api}
\bibitem{lodash} Dokumentacja Lo-dash - \url{http://lodash.com/docs}
\bibitem{jquery} Dokumentacja jQuery - \url{http://lodash.com/docs}
\bibitem{django} Dokumentacja Django - \url{https://docs.djangoproject.com/en/1.6/}
\bibitem{postgres} Dokumentacja PostgreSQL - \url{http://www.postgresql.org/docs/}
\bibitem{spa} Marcio Galli, \textit{Inner-browsing extending the browser navigation paradigm}, \url{https://developer.mozilla.org/en-US/docs/Inner-browsing_extending_the_browser_navigation_paradigm}

\end{thebibliography}

\end{document}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% coding: latin-2
%%% End:
